{
  "version": 4,
  "terraform_version": "1.11.3",
  "serial": 208,
  "lineage": "e2137bca-bdc2-08e4-f86c-e137e7292b59",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "eventbridge_sfn_walter_araujo_ingestao_dados",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-east-2:471112636571:rule/eventbridge_sfn_walter_araujo_ingestao_dados",
            "description": "Agendar o fluxo de ingestão de dados a cada 1 hora",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "eventbridge_sfn_walter_araujo_ingestao_dados",
            "is_enabled": true,
            "name": "eventbridge_sfn_walter_araujo_ingestao_dados",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(0/10 * ? * MON-FRI *)",
            "state": "ENABLED",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_sfn_state_machine.sfn_walter_araujo_ingestao_dados"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "eventbridge_sfn_walter_araujo_ingestao_dados",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:states:us-east-2:471112636571:stateMachine:sfn_walter_araujo_ingestao_dados",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "eventbridge_sfn_walter_araujo_ingestao_dados-terraform-20250429041907702000000001",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "rule": "eventbridge_sfn_walter_araujo_ingestao_dados",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "terraform-20250429041907702000000001"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_event_rule.eventbridge_sfn_walter_araujo_ingestao_dados",
            "aws_sfn_state_machine.sfn_walter_araujo_ingestao_dados"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sfn_state_machine",
      "name": "sfn_walter_araujo_ingestao_dados",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:states:us-east-2:471112636571:stateMachine:sfn_walter_araujo_ingestao_dados",
            "creation_date": "2025-04-29T03:36:53Z",
            "definition": "{\r\n    \"Comment\": \"A description of my state machine\",\r\n    \"StartAt\": \"Paralelo\",\r\n    \"States\": {\r\n      \"Paralelo\": {\r\n        \"Type\": \"Parallel\",\r\n        \"Branches\": [\r\n          {\r\n            \"StartAt\": \"Glue Ingestao FinancialDB\",\r\n            \"States\": {\r\n              \"Glue Ingestao FinancialDB\": {\r\n                \"Type\": \"Task\",\r\n                \"Resource\": \"arn:aws:states:::glue:startJobRun.sync\",\r\n                \"Arguments\": {\r\n                  \"JobName\": \"walter.araujo.glue_job_spark\"\r\n                },\r\n                \"End\": true\r\n              } \r\n            }\r\n          },\r\n          {\r\n            \"StartAt\": \"Glue Ingestao Taxa de Juros\",\r\n            \"States\": {\r\n              \"Glue Ingestao Taxa de Juros\": {\r\n                \"Type\": \"Task\",\r\n                \"Resource\": \"arn:aws:states:::glue:startJobRun.sync\",\r\n                \"Arguments\": {\r\n                  \"JobName\": \"walter.araujo.glue_job_shell\"\r\n                },\r\n                \"End\": true\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        \"Next\": \"Glue Carga Tabela SOT\"\r\n      },\r\n      \"Glue Carga Tabela SOT\": {\r\n        \"Type\": \"Task\",\r\n        \"Resource\": \"arn:aws:states:::glue:startJobRun\",\r\n        \"Arguments\": {\r\n          \"JobName\": \"walter.araujo.glue_job_spark_sot\"\r\n        },\r\n        \"End\": true\r\n      }\r\n    },\r\n    \"QueryLanguage\": \"JSONata\"\r\n  }",
            "description": "",
            "encryption_configuration": [
              {
                "kms_data_key_reuse_period_seconds": 0,
                "kms_key_id": "",
                "type": "AWS_OWNED_KEY"
              }
            ],
            "id": "arn:aws:states:us-east-2:471112636571:stateMachine:sfn_walter_araujo_ingestao_dados",
            "logging_configuration": [
              {
                "include_execution_data": false,
                "level": "OFF",
                "log_destination": ""
              }
            ],
            "name": "sfn_walter_araujo_ingestao_dados",
            "name_prefix": "",
            "publish": false,
            "revision_id": "c622d0e1-4a87-4231-aa9c-526936de8a0e",
            "role_arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "state_machine_version_arn": "",
            "status": "ACTIVE",
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "tracing_configuration": [
              {
                "enabled": false
              }
            ],
            "type": "STANDARD",
            "version_description": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "module": "module.IAM",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "aws_iam_policy_glue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::471112636571:policy/walter_araujo_policy_glue",
            "attachment_count": 1,
            "description": "IAM policy for Glue jobs",
            "id": "arn:aws:iam::471112636571:policy/walter_araujo_policy_glue",
            "name": "walter_araujo_policy_glue",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"glue:*\",\"s3:*\",\"athena:*\",\"states:*\",\"events:*\",\"cloudwatch:*\",\"lambda:*\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAW3MEALCNRDFEZBQTX",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.IAM",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "aws_iam_role_glue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"lambda.amazonaws.com\",\"glue.amazonaws.com\",\"states.amazonaws.com\"]}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-04-30T19:56:29Z",
            "description": "",
            "force_detach_policies": false,
            "id": "walter_araujo_role_glue",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::471112636571:policy/walter_araujo_policy_glue"
            ],
            "max_session_duration": 3600,
            "name": "walter_araujo_role_glue",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROAW3MEALCNSJZGMXTH5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.IAM",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "aws_iam_role_policy_attachment_glue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "walter_araujo_role_glue-20250430195630084100000001",
            "policy_arn": "arn:aws:iam::471112636571:policy/walter_araujo_policy_glue",
            "role": "walter_araujo_role_glue"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.IAM.aws_iam_policy.aws_iam_policy_glue",
            "module.IAM.aws_iam_role.aws_iam_role_glue"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "glue_job_shell",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:job/walter.araujo.glue_job_shell",
            "command": [
              {
                "name": "pythonshell",
                "python_version": "3.9",
                "runtime": "",
                "script_location": "s3://walter-araujo-bucket-source-code/etl_sor/ingestao_s3.py"
              }
            ],
            "connections": [],
            "default_arguments": {
              "library-set": "analytics"
            },
            "description": "",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "",
            "id": "walter.araujo.glue_job_shell",
            "job_run_queuing_enabled": false,
            "maintenance_window": "",
            "max_capacity": 1,
            "max_retries": 0,
            "name": "walter.araujo.glue_job_shell",
            "non_overridable_arguments": {},
            "notification_property": [],
            "number_of_workers": 0,
            "role_arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "security_configuration": "",
            "source_control_details": [],
            "tags": {},
            "tags_all": {},
            "timeout": 2880,
            "worker_type": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "glue_job_spark",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:job/walter.araujo.glue_job_spark",
            "command": [
              {
                "name": "glueetl",
                "python_version": "3",
                "runtime": "",
                "script_location": "s3://walter-araujo-bucket-source-code/etl_sor/main.py"
              }
            ],
            "connections": [],
            "default_arguments": {
              "--enable-glue-datacatalog": "true"
            },
            "description": "",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "5.0",
            "id": "walter.araujo.glue_job_spark",
            "job_run_queuing_enabled": false,
            "maintenance_window": "",
            "max_capacity": 2,
            "max_retries": 0,
            "name": "walter.araujo.glue_job_spark",
            "non_overridable_arguments": {},
            "notification_property": [],
            "number_of_workers": 2,
            "role_arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "security_configuration": "",
            "source_control_details": [],
            "tags": {},
            "tags_all": {},
            "timeout": 2880,
            "worker_type": "G.1X"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "glue_job_spark_sot",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:job/walter.araujo.glue_job_spark_sot",
            "command": [
              {
                "name": "glueetl",
                "python_version": "3",
                "runtime": "",
                "script_location": "s3://walter-araujo-bucket-source-code/etl_sot/ingestao_sot.py"
              }
            ],
            "connections": [],
            "default_arguments": {
              "--enable-glue-datacatalog": "true"
            },
            "description": "",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "5.0",
            "id": "walter.araujo.glue_job_spark_sot",
            "job_run_queuing_enabled": false,
            "maintenance_window": "",
            "max_capacity": 2,
            "max_retries": 0,
            "name": "walter.araujo.glue_job_spark_sot",
            "non_overridable_arguments": {},
            "notification_property": [],
            "number_of_workers": 2,
            "role_arn": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "security_configuration": "",
            "source_control_details": [],
            "tags": {},
            "tags_all": {},
            "timeout": 480,
            "worker_type": "G.1X"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "bucket_source_code",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::walter-araujo-bucket-source-code",
            "bucket": "walter-araujo-bucket-source-code",
            "bucket_domain_name": "walter-araujo-bucket-source-code.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "walter-araujo-bucket-source-code.s3.us-east-2.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "10a7da646f1ec2874a73c0300f7694b4a0058b840a1dd849ebb7584f9bbb1760",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2O1EMRO9K5GLX",
            "id": "walter-araujo-bucket-source-code",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-2",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_s3_bucket_object",
      "name": "glue_job_ingestao_s3",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": "private",
            "arn": "arn:aws:s3:::walter-araujo-bucket-source-code/etl_sor/ingestao_s3.py",
            "bucket": "walter-araujo-bucket-source-code",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "import awswrangler as wr\r\nimport pandas as pd\r\nfrom datetime import datetime\r\n\r\nS3_FILE_PATH = \"s3://recepcao-taxa-de-juros/interest_rate.csv\"\r\nS3_PARQUET_PATH = \"s3://walter-araujo-bucket-exemplo/interest_rate/\"\r\nDATABASE_NAME = \"walter_araujo_database_sor\"\r\nTABLE_NAME = \"interest_rate\"\r\n\r\ndef main():\r\n    df = wr.s3.read_csv(path=S3_FILE_PATH, dtype=str)\r\n\r\n    df[\"data_ingestao\"] = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\r\n\r\n    wr.s3.to_parquet(\r\n        df=df,\r\n        path=S3_PARQUET_PATH,\r\n        dataset=True,\r\n        mode=\"overwrite\",\r\n        database=DATABASE_NAME,\r\n        table=TABLE_NAME,\r\n        dtype={col: \"string\" for col in df.columns}\r\n    )\r\n\r\nif __name__ == \"__main__\":\r\n    from traceback import format_exc\r\n    try:\r\n        main()\r\n    except Exception:\r\n        print(format_exc())\r\n        exit(1)\r\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "d6eaf8a694198c5b53b968935bea78a2",
            "force_destroy": false,
            "id": "etl_sor/ingestao_s3.py",
            "key": "etl_sor/ingestao_s3.py",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_s3_bucket_object",
      "name": "glue_job_ingestao_sot",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": "private",
            "arn": "arn:aws:s3:::walter-araujo-bucket-source-code/etl_sot/ingestao_sot.py",
            "bucket": "walter-araujo-bucket-source-code",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "from pyspark.sql import SparkSession\r\nimport pyspark.sql.functions as F\r\n\r\ndef create_spark_session() -\u003e SparkSession:\r\n    return (\r\n        SparkSession.builder\r\n        .appName(\"MySQL to DataFrame\")\r\n        .enableHiveSupport()\r\n        .config(\"hive.exec.dynamic.partition.mode\", \"nonstrict\")\r\n        .config(\"hive.exec.dynamic.partition\", \"true\")\r\n        .getOrCreate()\r\n    )\r\n\r\ndef ultima_ingestao(spark: SparkSession, tabela: str):\r\n    return (\r\n        spark.sql(f\"SELECT MAX(data_ingestao) as ultima_ingestao FROM walter_araujo_database_sor.{tabela}\")\r\n        .collect()[0][0]\r\n    )\r\n\r\ndef main(spark: SparkSession):\r\n   \r\n    ultima_contas = ultima_ingestao(spark, \"contas\")\r\n    ultima_categorias = ultima_ingestao(spark, \"categorias\")\r\n    ultima_transacoes = ultima_ingestao(spark, \"transacoes\")\r\n    ultima_interest_rate = ultima_ingestao(spark, \"interest_rate\")\r\n\r\n    print(\"Últimas datas de ingestão:\")\r\n    print(\"Contas:\", ultima_contas)\r\n    print(\"Categorias:\", ultima_categorias)\r\n    print(\"Transações:\", ultima_transacoes)\r\n    print(\"Taxas:\", ultima_interest_rate)\r\n\r\n    contas_df = spark.table(\"walter_araujo_database_sor.contas\").filter(F.col(\"data_ingestao\") == ultima_contas)\r\n    categorias_df = spark.table(\"walter_araujo_database_sor.categorias\").filter(F.col(\"data_ingestao\") == ultima_categorias)\r\n    transacoes_df = spark.table(\"walter_araujo_database_sor.transacoes\").filter(F.col(\"data_ingestao\") == ultima_transacoes)\r\n    interest_rate_df = spark.table(\"walter_araujo_database_sor.interest_rate\").filter(F.col(\"data_ingestao\") == ultima_interest_rate)\r\n\r\n    df_final = (\r\n        transacoes_df\r\n        .join(contas_df, transacoes_df.conta_id == contas_df.id, \"left\")\r\n        .join(categorias_df, transacoes_df.categoria_id == categorias_df.id, \"left\")\r\n        .crossJoin(interest_rate_df)\r\n        .select(\r\n            F.expr(\"uuid()\").alias(\"identificador_unico\"),\r\n            transacoes_df[\"id\"].alias(\"transacao_id\"),\r\n            transacoes_df[\"conta_id\"],\r\n            transacoes_df[\"categoria_id\"],\r\n            F.to_timestamp(transacoes_df[\"data\"], \"yyyy-MM-dd\").alias(\"transacao_data\"),\r\n            F.year(F.to_date(transacoes_df[\"data\"], \"yyyy-MM-dd\")).alias(\"transacao_ano\"),\r\n            F.month(F.to_date(transacoes_df[\"data\"], \"yyyy-MM-dd\")).alias(\"transacao_mes\"),\r\n            F.dayofmonth(F.to_date(transacoes_df[\"data\"], \"yyyy-MM-dd\")).alias(\"transacao_dia\"),\r\n            transacoes_df[\"descricao\"].alias(\"transacao_descricao\"),\r\n            transacoes_df[\"valor\"].alias(\"transacao_valor\"),\r\n            transacoes_df[\"data_criacao\"].alias(\"transacao_data_criacao\"),\r\n            contas_df[\"nome\"].alias(\"conta_nome\"),\r\n            contas_df[\"descricao\"].alias(\"conta_descricao\"),\r\n            categorias_df[\"nome\"].alias(\"categoria_nome\"),\r\n            categorias_df[\"tipo\"].alias(\"categoria_tipo\"),\r\n            interest_rate_df[\"data_referencia\"].alias(\"taxa_juros_referencia\"),\r\n            interest_rate_df[\"porcentagem\"].alias(\"taxa_juros_porcentagem\"),\r\n            F.current_date().cast(\"string\").alias(\"data_ingestao\")\r\n        )\r\n    )\r\n\r\n    df_final.write.insertInto(\"walter_araujo_database_sot.sot_financeira\", overwrite=True)\r\n\r\nif __name__ == \"__main__\":\r\n    from traceback import format_exc\r\n    try:\r\n        spark = create_spark_session()\r\n        main(spark)\r\n    except:\r\n        print(format_exc())\r\n        exit(1)\r\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "5ba59e19b89d5756ad725e4015826e0f",
            "force_destroy": false,
            "id": "etl_sot/ingestao_sot.py",
            "key": "etl_sot/ingestao_sot.py",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.glue_job",
      "mode": "managed",
      "type": "aws_s3_bucket_object",
      "name": "glue_job_main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": "private",
            "arn": "arn:aws:s3:::walter-araujo-bucket-source-code/etl_sor/main.py",
            "bucket": "walter-araujo-bucket-source-code",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "from pyspark.sql import SparkSession, DataFrame\r\nimport pyspark.sql.functions as F\r\n\r\nDB_CONFIG = {\r\n    \"host\": \"mysql-financial-db.c3imkkke2ssh.us-east-2.rds.amazonaws.com\",\r\n    \"user\": \"admin\",\r\n    \"password\": \"F(VD]Qe8r!BOCg72\",\r\n    \"database\": \"financial_db\"\r\n}\r\n\r\ndef create_spark_session() -\u003e SparkSession:\r\n    return (\r\n        SparkSession\r\n        .builder\r\n        .appName(\"MySQL to DataFrame\")  # type: ignore\r\n        .config(\"hive.exec.dynamic.partition.mode\", \"nonstrict\")\r\n        .config(\"hive.exec.dynamic.partition\", \"true\")\r\n        .config(\"spark.jars.packages\", \"mysql:mysql-connector-java:8.0.32\")\r\n        .master(\"local[*]\")\r\n        .getOrCreate()\r\n    )\r\n\r\ndef read_mysql_table(spark: SparkSession, table_name: str, db_config: dict) -\u003e DataFrame:\r\n    return (\r\n        spark\r\n        .read\r\n        .format(\"jdbc\")\r\n        .option(\"driver\", \"com.mysql.cj.jdbc.Driver\")\r\n        .option(\"url\", f\"jdbc:mysql://{db_config['host']}/{db_config['database']}?useSSL=false\")\r\n        .option(\"ssl\", \"false\")\r\n        .option(\"user\", db_config[\"user\"])\r\n        .option(\"password\", db_config[\"password\"])\r\n        .option(\"dbtable\", table_name)\r\n        .load()\r\n    )\r\n\r\ndef processar_tabela(spark: SparkSession, tabela: str):\r\n    df = read_mysql_table(spark, tabela, DB_CONFIG)\r\n    df = df.withColumn(\"data_ingestao\", F.current_timestamp())\r\n    \r\n    df.write.insertInto(f\"walter_araujo_database_sor.{tabela}\", overwrite=True)\r\n\r\ndef main():\r\n    spark = create_spark_session()\r\n\r\n    tabelas = [\"contas\", \"categorias\", \"transacoes\"]\r\n\r\n    for tabela in tabelas:\r\n        processar_tabela(spark, tabela)\r\n\r\nif __name__ == \"__main__\":\r\n    from traceback import format_exc\r\n    try:\r\n        main()\r\n    except:\r\n        print(format_exc())\r\n        exit(1)\r\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream; charset=UTF-8",
            "etag": "f0dff501ab2ab084bf14361e73ac2bf1",
            "force_destroy": false,
            "id": "etl_sor/main.py",
            "key": "etl_sor/main.py",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_job.aws_s3_bucket.bucket_source_code"
          ]
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "data",
      "type": "archive_file",
      "name": "zip_python_code",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "8618a48335448f135fab821589b05abb0dda9363",
            "output_base64sha256": "w2G8YTRKC0R2AbsDOjlaP1gfOGXSOVZ3xU59nnJLSmA=",
            "output_base64sha512": "ul/w3O/jniSKyIZK4BEFb2ZlrLhILpObskrbIB0S05adCBbTkw8Rubw5lyFeH3rLGNeT4akF8idvfd0MIxMzDg==",
            "output_file_mode": null,
            "output_md5": "9bb4a22f6e11dfa2cc2758c2daf2f7e9",
            "output_path": "lambda/lambda_ingestao.zip",
            "output_sha": "8618a48335448f135fab821589b05abb0dda9363",
            "output_sha256": "c361bc61344a0b447601bb033a395a3f581f3865d2395677c54e7d9e724b4a60",
            "output_sha512": "ba5ff0dcefe39e248ac8864ae011056f6665acb8482e939bb24adb201d12d3969d0816d3930f11b9bc3997215e1f7acb18d793e1a905f2276f7ddd0c2313330e",
            "output_size": 1775,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "lambda",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "my_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-east-2:471112636571:function:walter_lambda_ingestion",
            "code_sha256": "w2G8YTRKC0R2AbsDOjlaP1gfOGXSOVZ3xU59nnJLSmA=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "lambda/lambda_ingestao.zip",
            "function_name": "walter_lambda_ingestion",
            "handler": "lambda_ingestao.lambda_handler",
            "id": "walter_lambda_ingestion",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:471112636571:function:walter_lambda_ingestion/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-05-02T21:59:47.064+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/walter_lambda_ingestion",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-2:471112636571:function:walter_lambda_ingestion:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:471112636571:function:walter_lambda_ingestion:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::471112636571:role/walter_araujo_role_glue",
            "runtime": "python3.11",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "w2G8YTRKC0R2AbsDOjlaP1gfOGXSOVZ3xU59nnJLSmA=",
            "source_code_size": 1775,
            "tags": {},
            "tags_all": {},
            "timeout": 3,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.lambda.data.archive_file.zip_python_code"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_database",
      "name": "walteraraujo_database_sor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:database/walter_araujo_database_sor",
            "catalog_id": "471112636571",
            "create_table_default_permission": [
              {
                "permissions": [
                  "ALL"
                ],
                "principal": [
                  {
                    "data_lake_principal_identifier": "IAM_ALLOWED_PRINCIPALS"
                  }
                ]
              }
            ],
            "description": "",
            "federated_database": [],
            "id": "471112636571:walter_araujo_database_sor",
            "location_uri": "",
            "name": "walter_araujo_database_sor",
            "parameters": {},
            "tags": {},
            "tags_all": {},
            "target_database": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_s3_bucket.bucket_exemplo"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_database",
      "name": "walteraraujo_database_sot",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:database/walter_araujo_database_sot",
            "catalog_id": "471112636571",
            "create_table_default_permission": [
              {
                "permissions": [
                  "ALL"
                ],
                "principal": [
                  {
                    "data_lake_principal_identifier": "IAM_ALLOWED_PRINCIPALS"
                  }
                ]
              }
            ],
            "description": "",
            "federated_database": [],
            "id": "471112636571:walter_araujo_database_sot",
            "location_uri": "",
            "name": "walter_araujo_database_sot",
            "parameters": {},
            "tags": {},
            "tags_all": {},
            "target_database": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_s3_bucket.bucket_exemplo_sot"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "interest_rate_table",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:table/walter_araujo_database_sor/interest_rate",
            "catalog_id": "471112636571",
            "database_name": "walter_araujo_database_sor",
            "description": "",
            "id": "471112636571:walter_araujo_database_sor:interest_rate",
            "name": "interest_rate",
            "open_table_format_input": [],
            "owner": "",
            "parameters": {},
            "partition_index": [],
            "partition_keys": [
              {
                "comment": "",
                "name": "data_ingestao",
                "type": "string"
              }
            ],
            "retention": 0,
            "storage_descriptor": [
              {
                "additional_locations": [],
                "bucket_columns": [],
                "columns": [
                  {
                    "comment": "",
                    "name": "data_referencia",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "porcentagem",
                    "parameters": {},
                    "type": "string"
                  }
                ],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://walter-araujo-bucket-exemplo/interest_rate",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": {},
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "",
                    "parameters": {},
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_glue_catalog_database.walteraraujo_database_sor",
            "module.tables.aws_s3_bucket.bucket_exemplo"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "tb_categorias",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:table/walter_araujo_database_sor/categorias",
            "catalog_id": "471112636571",
            "database_name": "walter_araujo_database_sor",
            "description": "",
            "id": "471112636571:walter_araujo_database_sor:categorias",
            "name": "categorias",
            "open_table_format_input": [],
            "owner": "",
            "parameters": {
              "classification": "parquet",
              "compressionType": "snappy"
            },
            "partition_index": [],
            "partition_keys": [
              {
                "comment": "",
                "name": "data_ingestao",
                "type": "string"
              }
            ],
            "retention": 0,
            "storage_descriptor": [
              {
                "additional_locations": [],
                "bucket_columns": [],
                "columns": [
                  {
                    "comment": "",
                    "name": "id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "nome",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "tipo",
                    "parameters": {},
                    "type": "string"
                  }
                ],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://walter-araujo-bucket-exemplo/categorias",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": {},
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "",
                    "parameters": {},
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_glue_catalog_database.walteraraujo_database_sor",
            "module.tables.aws_s3_bucket.bucket_exemplo"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "tb_contas",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:table/walter_araujo_database_sor/contas",
            "catalog_id": "471112636571",
            "database_name": "walter_araujo_database_sor",
            "description": "",
            "id": "471112636571:walter_araujo_database_sor:contas",
            "name": "contas",
            "open_table_format_input": [],
            "owner": "",
            "parameters": {
              "classification": "parquet",
              "compressionType": "snappy"
            },
            "partition_index": [],
            "partition_keys": [
              {
                "comment": "",
                "name": "data_ingestao",
                "type": "string"
              }
            ],
            "retention": 0,
            "storage_descriptor": [
              {
                "additional_locations": [],
                "bucket_columns": [],
                "columns": [
                  {
                    "comment": "",
                    "name": "id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "nome",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "descricao",
                    "parameters": {},
                    "type": "string"
                  }
                ],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://walter-araujo-bucket-exemplo/contas",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": {},
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "",
                    "parameters": {},
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_glue_catalog_database.walteraraujo_database_sor",
            "module.tables.aws_s3_bucket.bucket_exemplo"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "tb_sot_financeira",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:table/walter_araujo_database_sot/sot_financeira",
            "catalog_id": "471112636571",
            "database_name": "walter_araujo_database_sot",
            "description": "",
            "id": "471112636571:walter_araujo_database_sot:sot_financeira",
            "name": "sot_financeira",
            "open_table_format_input": [],
            "owner": "",
            "parameters": {
              "classification": "parquet",
              "compressionType": "snappy"
            },
            "partition_index": [],
            "partition_keys": [],
            "retention": 0,
            "storage_descriptor": [
              {
                "additional_locations": [],
                "bucket_columns": [],
                "columns": [
                  {
                    "comment": "",
                    "name": "identificador_unico",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "transacao_id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "conta_id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "categoria_id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "transacao_data",
                    "parameters": {},
                    "type": "timestamp"
                  },
                  {
                    "comment": "",
                    "name": "transacao_ano",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "transacao_mes",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "transacao_dia",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "transacao_descricao",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "transacao_valor",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "transacao_data_criacao",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "conta_nome",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "conta_descricao",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "categoria_nome",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "categoria_tipo",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "taxa_juros_referencia",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "taxa_juros_porcentagem",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "data_ingestao",
                    "parameters": {},
                    "type": "string"
                  }
                ],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://walter-araujo-bucket-exemplo-sot/sot_financeira",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": {},
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "",
                    "parameters": {},
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_glue_catalog_database.walteraraujo_database_sot",
            "module.tables.aws_s3_bucket.bucket_exemplo_sot"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "tb_transacoes",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-2:471112636571:table/walter_araujo_database_sor/transacoes",
            "catalog_id": "471112636571",
            "database_name": "walter_araujo_database_sor",
            "description": "",
            "id": "471112636571:walter_araujo_database_sor:transacoes",
            "name": "transacoes",
            "open_table_format_input": [],
            "owner": "",
            "parameters": {
              "classification": "parquet",
              "compressionType": "snappy"
            },
            "partition_index": [],
            "partition_keys": [
              {
                "comment": "",
                "name": "data_ingestao",
                "type": "string"
              }
            ],
            "retention": 0,
            "storage_descriptor": [
              {
                "additional_locations": [],
                "bucket_columns": [],
                "columns": [
                  {
                    "comment": "",
                    "name": "id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "conta_id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "categoria_id",
                    "parameters": {},
                    "type": "int"
                  },
                  {
                    "comment": "",
                    "name": "data",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "descricao",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "valor",
                    "parameters": {},
                    "type": "string"
                  },
                  {
                    "comment": "",
                    "name": "data_criacao",
                    "parameters": {},
                    "type": "string"
                  }
                ],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://walter-araujo-bucket-exemplo/transacoes",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": {},
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "",
                    "parameters": {},
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.tables.aws_glue_catalog_database.walteraraujo_database_sor",
            "module.tables.aws_s3_bucket.bucket_exemplo"
          ]
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "bucket_exemplo",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::walter-araujo-bucket-exemplo",
            "bucket": "walter-araujo-bucket-exemplo",
            "bucket_domain_name": "walter-araujo-bucket-exemplo.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "walter-araujo-bucket-exemplo.s3.us-east-2.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "10a7da646f1ec2874a73c0300f7694b4a0058b840a1dd849ebb7584f9bbb1760",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2O1EMRO9K5GLX",
            "id": "walter-araujo-bucket-exemplo",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-2",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "module": "module.tables",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "bucket_exemplo_sot",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::walter-araujo-bucket-exemplo-sot",
            "bucket": "walter-araujo-bucket-exemplo-sot",
            "bucket_domain_name": "walter-araujo-bucket-exemplo-sot.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "walter-araujo-bucket-exemplo-sot.s3.us-east-2.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "10a7da646f1ec2874a73c0300f7694b4a0058b840a1dd849ebb7584f9bbb1760",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2O1EMRO9K5GLX",
            "id": "walter-araujo-bucket-exemplo-sot",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-2",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    }
  ],
  "check_results": null
}
